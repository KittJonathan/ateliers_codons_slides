---
format:
  revealjs:
    theme: default
    fontsize: 1.8em
editor: visual
title-slide-attributes: 
  data-background-image: img/title.png
  data-background-opacity: 50%
---

![](img/title.png){fig-align="center"}

# Introduction

## Qu'est-ce que R ?

R est un **langage de programmation** et un **logiciel** utilisé pour réaliser des calculs statistiques et des graphiques.

R a été conçu en 1992 par **Ross Ihaka** et **Robert Gentleman** comme implémentation open source du langage de programmation S et publié en 1995.

Depuis, les utilisations de R se sont largement diversifiées :

-   analyses statistiques et workflows de data science

-   visualisations graphiques avancées

-   rapports automatisés

-   applications web

-   diaporamas, livres, et pages web

## Pourquoi (pas) R ?

**Avantages :**

-   libre, open source, et plateforme indépendant

-   large variété d'extensions proposant des fonctionnalités supplémentaires

-   compatible avec d'autres langages de programmation

-   puissant pour l'analyse et la visualisation de données

-   très large communauté en ligne

-   souvent expérimenté comme étant *simple à coder* (pour un novice)

**Inconvénients :**

-   performance : évolutivité, mémoire et vitesse

-   courbe d'apprentissage importante

-   potentiels problèmes de sécurité (applications web)

-   souvent expérimenté comme étant *étrange à coder* (pour un expert)

# R versus RStudio

## 

![](img/r_vs_rstudio.png){fig-align="center"}

-   **RStudio** est un environnement de développement intégré (IDE) open source

-   IDE pour R le plus populaire depuis plusieurs années

-   de nombreuses fonctionnalités et extensions pour faciliter les workflows (suivi de version, sommaire, add-ins, ...)

-   projets R et RMarkdown/Quarto

## Mise en pratique : installer R et RStudio

::: {.callout-tip appearance="simple" icon="false"}
-   Télécharger et installer R depuis cloud.r-project.org

-   Télécharger et installer RStudio Desktop depuis posit.co/download/rstudio-desktop
:::

## 

![](img/r_windows.png){fig-align="center"}

## 

![](img/r_studio_01.png){fig-align="center"}

## 

![](img/r_studio_02.png){fig-align="center"}

## Mise en pratique : "Hello World!"

::: {.callout-tip appearance="simple" icon="false"}
-   Ouvrez **R** et tapez les commandes suivantes :

    -   `"Hello World!"`

    -   `1`

-   Ouvrez **RStudio** et familiarisez-vous avec son environnement.

    -   Cliquez sur `Help > Cheatsheets > RStudio IDE Cheat Sheet` et parcourez le document.

    -   Cliquez sur `View > Panes > Pane Layout` et arrangez les panneaux selon votre préférence.

    -   Ouvrez un script en cliquant sur `File > New File > R Script`, ajoutez les deux commandes précédentes et sauvegardez le script.

    -   Exécutez les commandes en plaçant votre curseur à la fin de la première ligne du script et cliquez sur le bouton Run ou utilisez le raccourci clavier `Ctrl + Entrée`.

    -   Sauvegardez le script.
:::

## La console

Le code que vous exécutez apparaît dans la console - la ligne débute par un `>`.

La console affiche également la sortie - la ligne débute par `[1]`.

![](img/r_studio_03.png){fig-align="center"}

## Les commentaires

Les commentaires servent à :

-   inactiver du code qu'on ne souhaite plus exécuter

-   ajouter des commentaires qui expliquent notre raisonnement

Dans R, les commentaires sont codés par un hash `#`.

Tout ce qui suit sur la même ligne ne sera pas traité comme du code.

Par convention, nous utilisons `#` pour commenter du code et `##` pour ajouter des commentaires :

```{r, echo=TRUE, eval=TRUE}
# "Hello world!"  ## Je n'ai plus besoin de ce code mais je préfère le conserver.
```

## 

![](img/r_studio_04.png){fig-align="center"}

## 

![](img/r_studio_05.png){fig-align="center"}

## 

![](img/r_studio_06.png){fig-align="center"}

## 

![](img/r_studio_07.png){fig-align="center"}

## Les projets R

Les projets R (ou projets RStudio) vous fournissent un workflow robuste qui vous servira par la suite :

-   ils s'appuient sur l'idée que tous les fichiers associés à votre projet devraient être stockés dans le même dossier

    -   aide à trouver les fichiers

    -   augmente la reproductibilité

    -   facilite la collaboration

-   le répertoire de travail est défini dans le dossier où se trouve le fichier .Rproj

    -   assure un répertoire de travail correct

    -   indépendant des paramètres d'opération et de l'arborescence des dossiers

    -   limite les changements de répertoire lors de collaborations

Pour créer un projet R : `File > New Project …`

# Valeurs

## Valeurs

Tapez les commandes suivantes :

`1`

`"Hello World!"`

`x`

`pi`

## Valeurs

```{r, echo=TRUE, eval=TRUE, error=TRUE}
1
"Hello World!"
x
pi
```

# Fonctions

## Mise en pratique : opérations arithmétiques

::: {.callout-tip appearance="simple" icon="false"}
-   Tapez `2 + 3 et exécutez.`

-   Essayez d'autres opérateurs de calcul comme `-`, `*`, `/`, ou `^`.

-   Calculez la racine carrée d'un nombre avec `sqrt()`.
:::

::: {.callout-caution appearance="simple" icon="false"}
-   Quelle est la différence entre la valeur 5 obtenue à la première ligne et le calcul de la racine carrée à l'aide de `sqrt` ?
:::

## R est un calculateur !

```{r, echo=TRUE, eval=TRUE}
2 + 3
(59 + 73 + 2) * 5
1 / 200 * 30
sin(pi / 2)
10^12 * sqrt(4312)
log(exp(5))
```

## Fonctions

![](img/fonctions_01.png){fig-align="center"}

## Fonctions

![](img/fonctions_02.png){fig-align="center"}

## Fonctions

R possède une large collection de fonctions intégrées qu'on appelle comme ceci :

```{r, echo=TRUE, eval=FALSE}
function_name(arg1 = val1, arg2 = val2, ...)
```

Nous avons déjà vu certaines fonctions dans les exercices précédents :

`+`, `-`, `*`, `^`, `sqrt()`, `log()` sont toutes des fonctions.

## Fonctions

```{r, echo=TRUE, eval=FALSE}
sqrt()
log()
sin()
exp()
mean()
```

<br>

```{r, echo=TRUE, eval=TRUE}
sqrt(x = 25)
```

## Fonctions infixes

```{r, echo=TRUE, eval=FALSE}
+
-
^
%%
%in%
```

<br>

### Opérateur unaire

```{r, echo=TRUE, eval=TRUE}
-1
```

<br>

### Opérateur binaire

```{r, echo=TRUE, eval=TRUE}
12 %% 5
```

## Corps d'une fonction

```{r, echo=TRUE, eval=TRUE}
log
mean
methods(mean)
`+`
read.csv
```

## Corps d'une fonction

```{r, echo=TRUE, eval=TRUE}
read.table
```

## Arguments d'une fonction

```{r, echo=TRUE, eval=TRUE}
log(x = 25)  ## `base = exp(1)` par défaut
log(x = 25, base = 10)
log10(x = 25)  ## équivalent de `log(x, base = 10)`
log2(x = 25)  ## équivalent de `log(x, base = 2)`
```

## Apprendre à utiliser une fonction

```{r, echo=TRUE, eval=FALSE}
help(log)
?log
# curseur + F1
```

### Description

`log` computes logarithms, by default natural logarithms, `log10` computes common (i.e., base 10) logarithms, and `log2` computes binary (i.e., base 2) logarithms. The general form `log(x, base)` computes logarithms with base `base`.

## Apprendre à utiliser une fonction

```{r, echo=TRUE, eval=FALSE}
help(log)
?log
# curseur + F1
```

### Usage

```{r, echo=TRUE, eval=FALSE}
log(x, base = exp(1))
logb(x, base = exp(1))
log10(x)
log2(x)

log1p(x)

exp(x)
expm1(x)
```

## Apprendre à utiliser une fonction

```{r, echo=TRUE, eval=FALSE}
help(log)
?log
# curseur + F1
```

### Arguments

`x` a numeric or complex vector.

`base` a positive or complex number: the base with respect to which logarithms are computed. Defaults to `e = exp(1)`.

## Arguments d'une fonction : assignation implicite

```{r, echo=TRUE, eval=TRUE}
log(x = 25, base = 5)
log(25, 5)  ## le 1er argument est `x`, le 2nd `base`
log(5, 25)  ## le 1er argument est `x`, le 2nd `base`
log(25, base = 5)  ## le 1er argument est `x`
log(base = 5, 25)  ## fonctionne, mais à éviter
log(base = 5, x = 25)  ## soyez explicites si vous souhaitez modifier les positions des arguments
```

## Assignation implicite : attention !

Noms d''arguments explicites :

```{r, echo=TRUE, eval=TRUE}
## l'exemple utilise des vecteurs (séquences de nombres entourées par `c()`)
quantile(x = c(5, 1, 3), probs = c(0.25, 0.5, 0.75))
```

Assignation implicite par position :

```{r, echo=TRUE, eval=TRUE}
quantile(c(5, 1, 3), c(0.25, 0.5, 0.75))
```

Des erreurs dans la modification des positions peut engendrer tout un tas de problèmes :

```{r, echo=TRUE, eval=TRUE, error=TRUE}
quantile(c(0.25, 0.5, 0.75), c(5, 1, 3))
quantile(c(0.25, 0.5, 0.75), c(0.95, 0.345, 1))
```

## Mise en pratique : arguments d'une fonction

::: {.callout-caution appearance="simple" icon="false"}
Quelles lignes de code ci-dessous vont fonctionner ?
:::

`log(x = 1)`

`log(x = "1")`

`log(x)`

`log(value = 1)`

`` log(`1`) ``

`log(1)`

# Assignation et objets

## Mise en pratique : assignation et objets

::: {.callout-tip appearance="simple" icon="false"}
-   Tapez et exécutez `x <- 1` puis `x`.

-   Exécutez `x + 2`.

-   Exécutez `x <- 5` puis à nouveau `x + 2`.
:::

::: {.callout-caution appearance="simple" icon="false"}
-   Pourquoi n'y a-t-il aucune sortie après exécution de `x <- 1` ?

-   Que fait le symbole de la flèche `<-` ?

-   Quelle est la valeur de `x` à la fin ?

-   Que se passe-t-il si vous exécutez `y <- x` ? Et `y <- x <- 2` ?

-   Tapez et exécutez `y <- 2 <- x`. Que se passe-t-il ?

-   Pouvez-vous assigner une valeur et montrer le contenu de l'objet en même temps ?
:::

## Assignation et objets

![](img/objets_01.png){fig-align="center"}

## Assignation et objets

```{r, echo=TRUE, eval=TRUE}
x <- 1
x
x + 2
x <- 5
x + 2
x
```

## Assignation et objets

```{r, echo=TRUE, eval=TRUE, error=TRUE}
y <- x
y
y <- x <- 2
x
y
y <- 2 <- x
```

## L'environnement

Par défaut, les objets assignés existent dans l'**environnenemt global** appelé `R_GlobalEnv`. L'aperçu de tout ce que vous avec défini se trouve dans le **panneau d'environnement**.

![](img/rstudio_env_01.png){fig-align="center"}

## Assigner et afficher des objets

```{r, echo=TRUE, eval=TRUE}
print(a <- 123)
show(a <- 123)
(a <- 123)
```

## Syntaxe des noms d'objets

-   devrait être descriptif

    -   équilibre entre l'effort pour taper et la précision

-   doit commencer par une lettre

    -   `val1` valide - `1val` et `.val1` non valides

-   peut contenir d'autres symboles dans le nom

    -   nombres, points, et/ou tirets \_ : `val_1`

    -   pas de tiret - (ne pas utiliser le style kebab, voir diapo suivante)

-   sensible à la casse

    -   `myvalues`, `myValues` et `MyValues` sont des objets différents !

-   doit dans l'idéal suivre une convention cohérente

    -   ne pas mélanger différents styles : éviter `val1`, `val_2` et `val.3`

-   ne peut pas utiliser des noms réservés qui ont une fonction dans R

    -   `if`, `in`, `function`, `TRUE`, `FALSE`, `NA`, `NaN`

## 

![Illustration de [Allison Horst](https://allisonhorst.com/)](img/naming_conventions.png){fig-align="center"}

## Syntaxe des noms d'objets

C'est une question de lisibilité - décidez par vous-mêmes :

```{r, echo=TRUE, eval=FALSE}
i_prefer_snake_case
```

```{r, echo=TRUE, eval=FALSE}
otherPeopleLikeToUseCamelCase
```

```{r, echo=TRUE, eval=FALSE}
some.people.use.periods
```

```{r, echo=TRUE, eval=FALSE}
And_aFew.PeopleRENOUNCEconvention
```

<br>

```{r, echo=TRUE, eval=FALSE}
df_population_us
```

```{r, echo=TRUE, eval=FALSE}
dfPopulationUs
```

```{r, echo=TRUE, eval=FALSE}
df.population.us
```

```{r, echo=TRUE, eval=FALSE}
df_Population.US
```

## Syntaxe des noms d'objets

Noms d'objets potentiels :

-   `myvalue1`

-   `myValue1`

-   `MyValue1`

-   `my_value_1`

-   `my.value.1`

-   ... et toutes les combinaisons de minuscules/majuscules et de symboles

Utilisez le style que vous préférez, mais soyez consistents !

## Syntaxe d'assignation

```{r, echo=TRUE, eval=TRUE}
name <- "Jo"
name
"Clermont-Ferrand" -> city  ## assignation à droite
city
pays = "France"  ## un `=` simple peut aussi servir pour assigner
pays
```

L'utilisation du `=` est controversée car source de confusion, mais beaucoup plus répandue dans d'autres langages de programmation.

```{r, echo=TRUE, eval=TRUE, error=TRUE}
pays == "France"  ## un double `=` compare deux valeurs !
langue == "Francais"  ## un double `=` compare deux valeurs !
log(25, base = 5)  ## dans une fonction un `=` simple définit les arguments
```

## Utiliser des objets dans des fonctions

`one <- 1`

`log(one)`

## Utiliser des objets dans des fonctions

```{r, echo=TRUE, eval=TRUE, error=TRUE}
one <- 1
one
log(one)
one <- "1"
one
log(one)
```

# Types de données

Il existe plusieurs types de données basiques dans R : character, double, integer, complex, et logical.

```{r, echo=TRUE, eval=TRUE}
typeof("Hello World!")
typeof(1)
typeof(1L)
typeof(1i)
typeof(TRUE)
```

Chacun de ces types de données possède ses propres caractéristiques et utilisations.

## Types de données et classes atomiques

```{r, echo=TRUE, eval=TRUE}
typeof(1)
class(1)
typeof(1L)
class(1L)
typeof(1i)
class(1i)
```

Même si "integer" et "complex" sont des classes spécifiques dans R, elles sont considérées comme des sous-types du type de données plus général "numeric".

## Coercition en d'autres types de données

Les fonctions `as.*()` vous permettent de changer le type de données d'une valeur :

```{r, echo=TRUE, eval=TRUE}
as.character(1)
as.integer(1)
as.complex(1)
as.logical(1)
as.logical(0)
```

## Dates et horodatages

```{r, echo=TRUE, eval=TRUE}
typeof("2023-09-11 14:00:00")
```

### Objets "Date"

```{r, echo=TRUE, eval=TRUE}
as.Date("2023-09-11 14:00:00")
typeof(as.Date("2023-09-11 14:00:00"))
```

### Objets "Datetime"

```{r, echo=TRUE, eval=TRUE}
as.POSIXct("2023-09-11 14:00:00")
typeof(as.POSIXct("2023-09-11 14:00:00"))
as.POSIXlt("2023-09-11 14:00:00")
```

## Dates et horodatages

```{r, echo=TRUE, eval=TRUE}
date <- "2023-09-11 14:00:00"
as.POSIXct(date)
```

```{r, echo=TRUE, eval=TRUE}
as.POSIXct(date, format = "%d.%m.%Y %H:%M")
as.POSIXct(date, format = "%d.%m.%Y %H:%M", tz = "EST")
as.POSIXct(date, format = "%d.%m.%Y %H:%M", tz = "America/New_York")
as.POSIXct(date, format = "%d.%m.%Y %H:%M", tz = "US/Eastern")
```

# Valeurs manquantes
