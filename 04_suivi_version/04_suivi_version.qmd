---
format:
  revealjs:
    theme: custom.scss
    fontsize: 1.8em
editor: visual
title-slide-attributes: 
  data-background-image: title.png
  data-background-opacity: 50%
---

![](img/title.png)

## Les ateliers codons

<br>

-   Des **créneaux réguliers** pour **découvrir** et **progresser**

-   Deux parcours : **initiation** et **perfectionnement**

-   Une **équipe d'animation**

-   Des **supports** disponibles en ligne : [ateliers-codons.netlify.app/](https://ateliers-codons.netlify.app/)

<br>

#### Sources pour cet atelier :

<br>

-   [Happy Git with R](https://happygitwithr.com/)

-   [Pro Git](https://git-scm.com/book/fr/v2)

-   [Git tutorial for beginners: learn Git in 1 hour](https://www.youtube.com/watch?v=8JJ101D3knE&t=436s)

# Gestionnaire de version

## Gestionnaire de version

<br>

> Un gestionnaire de version est un système qui **enregistre l'évolution d'un fichier ou d'un ensemble de fichiers au cours du temps** de manière à ce qu'on puisse **rappeler une version antérieure** d'un fichier à tout moment.
>
> *Pro Git*

## Gestionnaire de version

<br>

![](img/vcs_simple.png)

## Sans gestion de version ...

<br>

![](img/no_vcs.png){fig-align="center"}

## Système de gestion de version

<br>

Un **système de gestion de version (VCS)** permet de :

<br>

-   ramener un fichier à un état précédent

-   ramener le projet complet à un état précédent

-   visualiser les changements au cours du temps

-   voir qui a modifié quelquechose qui pourrait poser un problème

-   voir qui a introduit un problème et quand

-   ...

## VCS centralisé vs. VCS distribué

<br>

![](img/centralised_vs_distributed_vcs.png){fig-align="center"}

## Pourquoi utiliser Git ?

<br>

-   Gratuit

-   Open Source

-   Très rapide

-   Evolutif

-   Création et fusion de branches

## Comment utiliser Git ?

<br>

-   En ligne de commande

-   A l'aide d'un Environnement de Développement Intégré (IDE)

    -   RStudio

    -   VS Code

-   A l'aide d'une Interface Utilisateur Graphique (GUI)

    -   Git Kraken

    -   Source Tree

# Installer Git

## Vérifier si Git est déjà installé

<br>

Ouvrez un terminal :

-   **macOS** : `Cmd` + `Espace` et tapez `terminal`

-   **Windows** : dans la barre de recherche, tapez `cmd`

<br>

Vous pouvez également ouvrir un terminal directement dans **RStudio** :

-   `Tools` \> `Teminal` \> `New Terminal`

-   `Alt` + `Maj` + `R`

-   Cliquez sur l'onglet Teminal

![](img/rstudio_terminal.png)

## Vérifier si Git est déjà installé

<br>

Si Git est installé, vous pouvez utiliser **Git Bash** :

![](img/git_bash_rstudio.png)

## Vérifier si Git est déjà installé

<br>

Dans le terminal, tapez les commandes suivantes :

<br>

-   Afficher l'emplacement de Git sur votre ordinateur :

`which git`

<br>

-   Afficher la version de Git installée sur votre ordinateur :

`git --version`

`git -v`

## Installer Git

<br>

![](img/download_git.png)

# Configurer Git

## Configurer Git

<br>

Il est possible de configurer Git pour optimiser son utilisation.

Pour le moment, nous allons renseigner les informations suivantes :

-   nom d'utilisateur

-   e-mail d'utilisateur

-   éditeur de texte par défaut

<br>

La configuration de Git s'effectue dans un fichier caché nommé **`.gitconfig`**, placé à la racine de votre répertoire d'utilisateur (votre "home").

## Configurer Git

<br>

La configuration de Git peut se faire à trois niveaux :

<br>

-   **System** : tous les utilisateurs

-   **Global** : tous les répertoires de l'utilisateur

-   **Local** : répertoire courant

## Configurer Git

<br>

![](img/git_config.png)

## Configurer Git - nom et e-mail

<br>

Tapez les commandes suivantes dans le terminal :

`git config --global user.name "Prenom Nom"`

`git config --global user.email prenom.nom@mail.com`

## Configurer Git - éditeur de texte par défaut

<br>

Pour configurer l'éditeur de texte par défaut, copiez le chemin d'accès vers l'éditeur de votre choix (par ex. *Notepad ++*)

![](img/path_editor.png)

<br>

Tapez ensuite la commande suivante (**attention aux guillemets**) :

`git config --global core.editor '"C:\Program Files\Notepad++\notepad++.exe"'`

## Configurer Git

<br>

Vous pouvez ouvrir le fichier de configuration de Git (`.gitconfig`) :

<br>

-   Dans le terminal

    `git config --global --list`

-   Dans l'éditeur de texte

    `git config --global -e`

## Configurer Git

<br>

![](img/git_config_example.png)

# Obtenir de l'aide

## Obtenir de l'aide

<br>

-   Dans un moteur de recherche, tapez `git config doc`

    ::: columns
    ::: {.column width="50%"}
    ![](img/git_config_help_1.png)
    :::

    ::: {.column width="50%"}
    ![](img/git_config_help_2.png)
    :::
    :::

-   Dans le terminal, tapez `git config --help`

-   Pour une version synthétique de l'aide, utilisez `git config -h`

# Initialiser un dépôt Git

## Initialiser un dépôt Git

<br>

-   Naviguez jusqu'à l'emplacement sur votre ordinateur où vous souhaitez créer un nouveau répertoire

    -   Utilisez la commande `cd` (change directory) pour naviguer

    -   Le répertoire actuel est noté "point" `.`

    -   Pour revenir d'un niveau en arrière, utilisez `cd ..`

-   Créez un nouveau répertoire : `mkdir tuto_git`

    -   `mkdir` : make directory

-   Placez-vous dans ce nouveau répertoire : `cd tuto_git`

-   Initialisez un dépôt Git dans ce répertoire : `git init`

## Initialiser un dépôt Git

<br>

![](img/git_init_3.png)

<br>

Dans le répertoire `tuto_git`, un **répertoire caché .`git`** a été créé.

## Initialiser un dépôt Git

<br>

Pour afficher le contenu d'un répertoire, utilisez la commande `ls` (list) :

-   cette commande n'affiche pas les fichiers ou dossiers cachés

-   utilisez `ls -a` (all) pour afficher tout le contenu du répertoire

-   utilisez `ls -la` (list all) pour afficher tout le contenu sous forme de liste

![](img/git_init_4.png)

<br>

Vous pouvez ouvrir ce répertoire `.git` à l'aide de la commande `open .git`.

## Initialiser un dépôt Git

<br>

Le répertoire caché `.git` contient toutes les informations nécessaires à Git pour suivre l'historique de votre dépôt.

Si vous changez d'avis et souhaitez supprimer ce répertoire `.git`, utilisez la commande suivante :

![](img/rm_rf_git.png)

# Le workflow Git

## Le workflow Git

<br>

![](img/git_basic_workflow.png)

## Créer des fichiers

<br>

![](img/git_workflow_00.png)

## Créer des fichiers

<br>

La commande `echo` permet d'ajouter du contenu dans un fichier :

`echo hello > file1.txt`

`echo hello > file2.txt`

<br>

![](img/git_workflow_01.png)

## Afficher l'état du dépôt

<br>

Pour afficher l'état du dépôt, utilisez la commande suivante :

`git status`

<br>

![](img/git_workflow_02.png)

## Ajouter des fichiers à la zone d'index

<br>

La commande `git add` permet d'ajouter des fichiers à la zone d'index :

<br>

-   en nommant les fichiers un par un :

    `git add file1.txt file2.txt`

-   en utilisant un motif

    `git add *.txt`

-   en ajoutant tous les fichiers du répertoire

    `git add .`

## Ajouter des fichiers à la zone d'index

<br>

`git add file1.txt file2.txt`

<br>

![](img/git_workflow_03.png)

## Ajouter des fichiers à la zone d'index

<br>

![](img/git_workflow_04.png)

## Configurer Git - fin de ligne

<br>

![](img/crlf.png)

## Configurer Git - fin de ligne

<br>

![](img/core_autocrlf.png)

|               |                                       |
|---------------|---------------------------------------|
| Windows       | `git config --global auto.crlf true`  |
| macOS / Linux | `git config --global auto.crlf input` |

## Modifier un fichier

<br>

L'opérateur `>>` permet d'ajouter une ligne dans un fichier existant :

`echo world >> file1.txt`

<br>

![](img/git_workflow_05.png)

## Modifier un fichier

<br>

![](img/git_workflow_06.png)

## Modifier un fichier

<br>

`git add file1.txt`

<br>

![](img/git_workflow_07.png)

## Modifier un fichier

<br>

![](img/git_workflow_08.png)

## Sauvegarder un instantané de la zone d'index

<br>

Pour créer un instantané de la zone d'index, utilisez la commande suivante :

<br>

![](img/git_commit.png)

<br>

Si vous avez besoin de taper un message plus long, la commande `git commit` ouvrira votre éditeur de texte.

## Sauvegarder un instantané de la zone d'index

<br>

`git commit -m "commit initial"`

<br>

![](img/git_workflow_09.png)

## Sauvegarder un instantané de la zone d'index

<br>

![](img/git_workflow_10.png)

## Sauvegarder un instantané de la zone d'index

<br>

![](img/git_workflow_11.png)

<br>

-   100644 : fichier "normal"

-   100755 : fichier exécutable

-   120000 : lien symbolique

## Sauvegarder un instantané

<br>

`git commit -m "commit initial"`

<br>

![](img/git_workflow_12.png)

## Les commits - quand ?

<br>

#### Un commit n'est pas un Ctrl + S !

-   Un commit contient des **modifications significatives** que l'on souhaite sauvegarder

-   Trouver le **juste milieu** entre un commit "trop petit" et un commit "trop grand"

![](img/commit_size.png)

## Les commits - quoi ?

<br>

#### Ne pas mettre dans un même commit des mofications qui n'ont rien à voir les unes avec les autres.

-   Un des principaux intérêts de Git est de pouvoir revenir à un état antérieur d'un fichier.

-   Si les modifications concernent différentes parties de votre projet, utilisez des commits différents (intérêt de la zone d'index)

<br>

![](img/commit_content.png)

## Les commits - comment ?

<br>

#### Le message associé à un commit doit décrire ce qui a été fait et pourquoi.

-   Etre le plus explicite possible

-   Choisir une convention et s'y tenir

<br>

![XKCD](img/git_commit_message.png)

## Commit "direct"

<br>

Il est possible (mais **pas toujours souhaitable**) de faire un commit sans passer par l'étape d'ajout dans la zone d'index.

<br>

![](img/git_commit_am.png)

Cette commande fonctionne pour les fichiers qui sont **déjà suivis** par Git (les fichiers qui existent dans la zone d'index).

## Commit "direct"

<br>

`echo test >> file1.txt`

`git commit -am "ajout d'une ligne de texte dans file1.txt"`

<br>

![](img/git_workflow_13.png)

## Supprimer un fichier

<br>

La commande `rm` permet de supprimer un fichier du répertoire.

`rm file2.txt`

<br>

La commande `ls` permet de faire la liste des fichiers présents **dans le répertoire**.

Pour lister les fichiers présents dans la **zone d'index**, utilisez `git ls-files`.

![](img/git_workflow_14.png)

Le fichier supprimé est bien **absent du répertoire de travail** mais **toujours présent dans la zone d'index**.

## Supprimer un fichier

<br>

`rm file2.txt`

<br>

![](img/git_workflow_15.png)

## Supprimer un fichier

<br>

Pour retirer de la zone d'index un fichier supprimé du répertoire, il faut procéder de la même façon que pour un commit "classique" :

<br>

`git add file2.txt`

<br>

![](img/git_workflow_16.png)

Cette commande **ajoute la suppression du fichier à la zone d'index**.

<br>

## Supprimer un fichier

<br>

Pour que la suppression du fichier soit effective, effectuons un commit :

`git commit -m "suppression d'un fichier inutile"`

<br>

![](img/git_workflow_17.png)

## Supprimer un fichier

<br>

`git commit -m "suppression d'un fichier inutile"`

<br>

![](img/git_workflow_18.png)

## Supprimer un fichier

<br>

Il est possible de supprimer un fichier à la fois du répertoire de travail et de la zone d'index, à l'aide de la commande `git rm`.

<br>

La commande `touch` permet de créer un fichier vide :

`touch file3.txt`

<br>

![](img/git_workflow_19.png)

## Supprimer un fichier

<br>

Il est possible de supprimer un fichier à la fois du répertoire de travail et de la zone d'index, à l'aide de la commande `git rm`.

<br>

`git add file3.txt`

<br>

![](img/git_workflow_20.png)

## Supprimer un fichier

<br>

Il est possible de supprimer un fichier à la fois du répertoire de travail et de la zone d'index, à l'aide de la commande `git rm`.

<br>

`git commit -m "creation du fichier file3.txt"`

<br>

![](img/git_workflow_21.png)

## Supprimer un fichier

<br>

Il est possible de supprimer un fichier à la fois du répertoire de travail et de la zone d'index, à l'aide de la commande `git rm`.

<br>

`git rm file3.txt`

<br>

![](img/git_workflow_22.png)

## Supprimer un fichier

<br>

Il est possible de supprimer un fichier à la fois du répertoire de travail et de la zone d'index, à l'aide de la commande `git rm`.

<br>

![](img/git_workflow_23.png)

## Supprimer un fichier

<br>

Il est possible de supprimer un fichier à la fois du répertoire de travail et de la zone d'index, à l'aide de la commande `git rm`.

<br>

`git add file3.txt`

`git commit -m "suppression du fichier file3.txt"`

<br>

![](img/git_workflow_24.png)

## Retirer un fichier de la zone d'index

<br>

Imaginons qu'un fichier a été ajouté à la zone d'index par erreur (par exemple en utilisant `git add .` ou `git add -A`).

<br>

`touch file4.txt`

`git add .`

<br>

![](img/git_workflow_25.png)

## Retirer un fichier de la zone d'index

<br>

Imaginons qu'un fichier a été ajouté à la zone d'index par erreur (par exemple en utilisant `git add .` ou `git add -A`).

La commande `git restore --staged` permet de retirer un fichier de la zone d'index sans le supprimer du répertoire de travail.

<br>

![](img/git_workflow_26.png)

## Retirer un fichier de la zone d'index

<br>

Imaginons qu'un fichier a été ajouté à la zone d'index par erreur (par exemple en utilisant `git add .` ou `git add -A`).

La commande `git restore --staged` permet de retirer un fichier de la zone d'index sans le supprimer du répertoire de travail.

<br>

`git restore --staged file4.txt`

<br>

![](img/git_workflow_27.png)
